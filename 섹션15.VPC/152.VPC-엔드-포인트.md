## 1. VPC 엔드포인트 개요

VPC 엔드포인트는 **퍼블릭 인터넷을 거치지 않고** AWS 서비스에 프라이빗하게 연결할 수 있게 해주는 가상 장치입니다.

* **보안성:** 모든 데이터가 AWS 내부 네트워크를 통하므로 보안이 강화됩니다.
* **비용 및 효율:** 인터넷 게이트웨이(IGW), NAT 인스턴스, NAT 게이트웨이가 불필요합니다.
* **가용성:** 수평으로 확장되며 중복 구성이 가능하여 높은 가용성을 제공합니다.

---

## 2. 게이트웨이 엔드포인트 (Gateway Endpoint)

특정 AWS 서비스(S3, DynamoDB)를 위해 라우팅 테이블에 경로를 추가하는 방식입니다.

* **대상 서비스:** Amazon **S3**, **DynamoDB** (단 두 가지만 지원)
* **작동 원리:**
* VPC 수준에서 정의되며, 서브넷의 **라우팅 테이블을 업데이트**해야 합니다.
* 라우팅 테이블 예시: `Destination(S3 Public IP)` -> `Target(vpce-xxxxxxxx)`


* **주요 특징:**
* **DNS:** 서비스의 퍼블릭 호스트 이름을 그대로 사용하며, 라우팅 테이블이 이를 엔드포인트로 리디렉션합니다.
* **확장 제약:** VPC 내부에서만 유효합니다. **VPN, Direct Connect, Transit Gateway, VPC 피어링을 통한 공유가 불가능**합니다. (해당 연결을 통하는 온프레미스 장비는 게이트웨이 엔드포인트 이용 불가)



---

## 3. 인터페이스 엔드포인트 (Interface Endpoint)

대부분의 AWS 서비스에서 사용되는 방식이며, **PrivateLink** 기술을 기반으로 합니다.

* **작동 원리:**
* 서브넷 내부에 **ENI(Elastic Network Interface)**를 생성하여 프라이빗 IP를 할당받습니다.
* 보안 그룹(Security Group)을 적용하여 트래픽 제어가 가능합니다.


* **프라이빗 DNS 활성화 (Private DNS):**
* 활성화 시, 서비스의 퍼블릭 URL(예: `athena.us-east-1.amazonaws.com`)을 호출하면 자동으로 인터페이스 엔드포인트의 **프라이빗 IP**로 해석됩니다.
* **필수 설정:** VPC 설정에서 `Enable DNS Hostnames`와 `Enable DNS Support`가 모두 `true`여야 합니다.


* **주요 특징:**
* **공유 가능:** 게이트웨이와 달리 **Direct Connect나 Site-to-Site VPN**을 통해 온프레미스에서도 이 엔드포인트에 접속할 수 있습니다.



---

## 4. 요약 및 문제 해결 (Troubleshooting)

### 서비스별 비교 테이블

| 구분 | 게이트웨이 엔드포인트 | 인터페이스 엔드포인트 |
| --- | --- | --- |
| **대상 서비스** | S3, DynamoDB | CloudWatch, Athena 등 대부분의 서비스 |
| **구현 방식** | 라우팅 테이블 경로 추가 | 서브넷 내 ENI 생성 |
| **보안 제어** | 엔드포인트 정책 | **보안 그룹**, 엔드포인트 정책 |
| **외부 연결** | 공유 불가 (VPC 내부 한정) | **VPN, Direct Connect 등을 통해 공유 가능** |

### 트러블슈팅 체크리스트

1. **DNS 설정 확인:** VPC의 DNS Support/Hostnames 설정이 활성화되어 있는가?
2. **라우팅 테이블:** 게이트웨이 방식 사용 시, 해당 서브넷 라우팅 테이블에 엔드포인트 경로가 있는가?
3. **보안 그룹:** 인터페이스 방식 사용 시, ENI에 할당된 보안 그룹이 통신을 허용하는가?
