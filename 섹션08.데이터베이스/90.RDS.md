## 1. RDS 기본 사항 및 아키텍처

RDS는 관리형 서비스이지만, 사용자가 직접 **인스턴스 유형을 선택(Provisioning)**해야 합니다.

* **지원 엔진:** PostgreSQL, MySQL, MariaDB, Oracle, MS SQL Server, IBM DB2.
* **배포 환경:** 보안을 위해 주로 **VPC의 Private Subnet**에 배치하며, **Security Group**으로 접근을 제어합니다.
* **Lambda 연동:** Lambda가 RDS에 접근하려면 반드시 **Private VPC Subnet** 내에 배포되어야 합니다.
* **스토리지:** EBS 볼륨을 사용하며, **스토리지 자동 확장(Autoscaling)** 기능을 지원합니다.

---

## 2. 백업, 스냅샷 및 이벤트

* **자동 백업:** 설정된 기간 동안 시점 복구(Point-in-time recovery)가 가능합니다.
* **스냅샷:** 사용자가 수동으로 생성하며, 원하는 기간만큼 보관 가능합니다. **타 리전 복제**가 가능하여 재해 복구(DR)에 핵심적입니다.
* **RDS 이벤트 알림:** SNS와 연동하여 장애, 운영 상태, 백업 시작 등의 이벤트를 알림으로 받을 수 있습니다.

---

## 3. 가용성(Multi-AZ) vs 확장성(Read Replica)

| 구분 | Multi-AZ (고가용성) | Read Replica (확장성) |
| --- | --- | --- |
| **목적** | 재해 복구 및 장애 조치 (DR) | 읽기 성능 분산 (Scalability) |
| **복제 방식** | **동기(Synchronous)** 복제 | **비동기(Asynchronous)** 복제 |
| **구조** | 하나의 DNS 이름 사용 (자동 Failover) | 별도의 엔드포인트 존재 |
| **특징** | Standby 인스턴스는 평소에 접근 불가 | 읽기 전용으로 접근 가능, **Cross-Region** 가능 |

### Route 53을 활용한 읽기 분산

* 애플리케이션 코드 수정을 줄이기 위해 **Route 53 가중치 기반 레코드(Weighted Record)**를 사용합니다.
* 각 리플리카 엔드포인트에 가중치(예: 25%씩)를 부여하고 **Health Check**를 연결하면, 특정 리플리카 장애 시 자동으로 제외됩니다.

---

## 4. 보안 및 인증

* **암호화:** EBS 볼륨/스냅샷(KMS), 전송 중 데이터(SSL/TLS) 암호화를 지원합니다.
* **TDE (Transparent Data Encryption):** Oracle 및 SQL Server에서 지원합니다.
* **IAM DB 인증:**
  * MySQL, PostgreSQL, MariaDB에서 지원.
  * 패스워드 대신 **15분 수명의 인증 토큰**을 사용합니다.
  * 중앙 집중식 권한 관리가 가능하며, EC2 인스턴스 프로필과 연동하기 쉽습니다.
* *주의:* DB 내부의 세부 권한(Select, Update 등)은 여전히 DB 엔진 내부에서 설정해야 합니다.



---

## 5. 엔진별 특이사항 (Oracle & MySQL)

### [Oracle RDS 특수성]

* **백업:** RDS 자체 백업은 RDS로만 복원 가능합니다. **Oracle Rman**은 S3를 통해 외부 DB로의 복제는 가능하지만 RDS로의 복원은 불가합니다.
* **RAC 미지원:** Oracle Real Application Clusters(RAC)는 RDS에서 지원되지 않습니다. (필요 시 EC2에 직접 설치해야 함)

### [MySQL 마이그레이션]

* `mysqldump` 도구를 사용하여 RDS MySQL 데이터를 온프레미스나 EC2로 내보낼 수 있으며, 이후 복제 메커니즘을 통해 동기화 후 전환합니다.

---

## 6. 고급 기능 및 솔루션 아키텍처

### RDS Proxy (Lambda 최적화)

* Lambda는 실행 시마다 커넥션을 맺으므로 **"Too many connections"** 오류가 발생하기 쉽습니다.
* **RDS Proxy**는 커넥션 풀을 관리하여 유휴 연결을 정리하고 효율성을 높입니다.
* VPC 내/외부의 Lambda와 RDS 사이에서 중계 역할을 하며 IAM 인증을 지원합니다.

### 크로스 리전 장애 조치 (Cross-Region Failover)

1. 타 리전에 **Read Replica** 생성.
2. CloudWatch Alarm으로 메인 DB 상태 감시.
3. 장애 발생 시 **Lambda** 트리거.
4. Lambda가 Read Replica를 **Master로 승격(Promote)**시키고 Route 53 DNS를 업데이트합니다.
