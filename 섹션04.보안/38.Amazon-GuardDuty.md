## 🛡️ Amazon GuardDuty 개요

Amazon GuardDuty는 AWS 계정, 워크로드 및 데이터를 보호하기 위해 머신 러닝(ML) 알고리즘, 이상 감지, 제삼자 데이터를 활용하여 **지능형 위협을 탐지**하는 보안 서비스입니다.

* **간편한 활성화:** 단 한 번의 클릭으로 활성화 가능하며, 별도의 소프트웨어 설치가 필요 없습니다.
* **무료 체험:** 30일 무료 평가판을 제공합니다.
* **비침해적 방식:** 기존 인프라 성능에 영향을 주지 않고 백그라운드에서 데이터를 분석합니다.

---

## 📊 데이터 소스 (Input Data)

GuardDuty는 다음과 같은 다양한 로그 데이터를 분석하여 위협을 찾아냅니다.

### **1. 기본 데이터 소스 (기본 활성화)**

이 소스들은 GuardDuty 활성화 시 자동으로 분석 대상에 포함됩니다.

* **AWS CloudTrail 로그:** 관리 이벤트(VPC 서브넷 생성 등) 및 데이터 이벤트(S3 API 호출 등) 분석.
* **VPC Flow Logs:** 이상 인터넷 트래픽 및 의심스러운 IP 주소와의 통신 감지.
* **DNS Logs:** DNS 쿼리 내 인코딩된 데이터를 통한 데이터 유출(Exfiltration) 및 손상된 EC2 인스턴스 확인.

### **2. 선택적 기능 (Optional Features)**

특정 워크로드 보호를 위해 추가로 활성화할 수 있는 데이터 소스입니다.

* **S3 데이터 이벤트:** S3 버킷 내 객체 수준 작업 감지.
* **EBS 볼륨 스캔:** 멀웨어 감지를 위해 EBS 볼륨 분석.
* **Lambda 네트워크 활동:** Lambda 함수의 비정상적인 네트워크 통신 감지.
* **RDS & Aurora:** 로그인 활동 분석을 통한 무단 액세스 시도 감지.
* **EKS 보호:** Audit 로그 분석 및 런타임 모니터링.

---

## ⚡ 위협 탐지 및 자동화 (Findings & Automation)

GuardDuty가 위협을 감지하면 **'결과(Findings)'**를 생성하며, 이를 통해 사후 조치를 자동화할 수 있습니다.

* **Amazon EventBridge 통합:** 위협이 탐지되면 이벤트를 생성합니다.
* **자동화 시나리오:**
  * **AWS Lambda:** 위협 IP 차단 등 즉각적인 보안 조치 실행.
  * **Amazon SNS:** 보안 담당자에게 알림 발송.



> **💡 시험 포인트: 암호화폐(Cryptocurrency) 공격 탐지**
> GuardDuty는 **암호화폐 채굴 공격 탐지**에 특화되어 있습니다. 전용 결과 유형(Finding Type)을 보유하고 있어, 계정 내 자원이 채굴에 오용되는 것을 효과적으로 차단합니다.

---

## 🏢 조직 관리 (Delegated Administrator)

AWS Organizations 환경에서 여러 계정의 GuardDuty를 효율적으로 관리하기 위한 기능입니다.

* **위임 관리자(Delegated Administrator):** 조직의 관리 계정(Master Account)은 멤버 계정 중 하나를 '위임 관리자'로 지정할 수 있습니다.
* **권한:** 위임 관리자로 지정된 계정은 조직 내 **모든 계정**의 GuardDuty를 활성화하고 관리할 수 있는 권한을 가집니다.
* **설정 방법:** 반드시 **조직 관리 계정**에서만 위임 관리자를 선정할 수 있습니다.

---

### **핵심 요약 테이블**

| 구분 | 주요 내용 |
| --- | --- |
| **핵심 기술** | 머신 러닝, 이상 감지 (Anomaly Detection) |
| **주요 로그** | CloudTrail, VPC Flow Logs, DNS Logs |
| **특화 기능** | 암호화폐 채굴(Crypto-mining) 탐지 |
| **대응 체계** | EventBridge → Lambda (조치) / SNS (알림) |
| **멀티 계정** | 위임 관리자(Delegated Admin)를 통한 통합 관리 |