## AWS 로드 밸런서 SSL 아키텍처 정리

### 1. 고전적 아키텍처 (ALB + ACM)

가장 일반적이고 관리가 쉬운 형태입니다. SSL 종료(Termination)가 로드 밸런서에서 일어납니다.

* **구성**: `사용자` --(HTTPS)--> `ALB (SSL 인증서)` --(HTTP)--> `EC2 인스턴스`
* **특징**:
* **ACM(AWS Certificate Manager)**을 통해 인증서를 간편하게 관리하고 로드합니다.
* LB와 EC2 사이는 HTTP(평문)로 통신하여 EC2의 컴퓨팅 부하를 줄입니다.
* 설정이 매우 간단하며 확장성이 뛰어납니다.



---

### 2. End-to-End 암호화 아키텍처 (NLB + EC2 직접 설치)

보안 규정상 데이터가 네트워크 통과 시 반드시 암호화되어야 하는 경우 사용합니다.

* **구성**: `사용자` --(HTTPS)--> `NLB (TCP 통과)` --(HTTPS)--> `EC2 (SSL 인증서)`
* **인증서 배포 방식**:
1. **SSM Parameter Store**에 SSL 인증서를 안전하게 저장합니다.
2. EC2 실행 시 **User Data(사용자 데이터)** 스크립트를 통해 인증서를 가져옵니다.
3. **IAM 역할(Role)**을 통해 EC2가 Parameter Store에 접근할 수 있는 권한을 부여합니다.


* **단점**:
* **CPU 리소스 소모**: EC2가 직접 SSL 암/복호화를 수행하므로 부하가 증가합니다.
* **관리 복잡성**: 각 인스턴스마다 인증서 관리가 필요합니다.
* **보안 위험**: SSH 접속 권한이 있는 관리자가 인증서 파일에 접근할 가능성이 있습니다.



---

### 3. CloudHSM 기반 SSL 오프로딩 (최고 수준 보안)

금융권이나 고도의 보안이 필요한 환경에서 사용하며, SSL 처리를 전용 하드웨어로 넘깁니다.

* **구성**: `사용자` --(HTTPS)--> `NLB` --(HTTPS)--> `EC2 (SSL 가속)` <--> `CloudHSM`
* **작동 원리**:
* EC2 내의 웹 서버(NGINX, Apache, IIS 등)가 SSL 처리를 **CloudHSM** 장치로 오프로딩(전송)합니다.
* **CloudHSM** 내부에 SSL 프라이빗 키가 저장되며, 키는 절대로 HSM 장치 외부로 유출되지 않습니다.


* **구현 방법**:
1. CloudHSM에 **CU(Crypto User)** 계정을 생성합니다.
2. EC2 인스턴스가 이 CU 계정을 사용하도록 설정합니다. (자격 증명은 SSM Parameter Store 등에 안전하게 보관 가능)


* **장점**:
* **성능 향상**: 전용 하드웨어 가속을 통해 EC2의 CPU 리소스를 절약합니다.
* **강력한 보안**: 프라이빗 키가 하드웨어 내부에서만 존재하므로 탈취가 거의 불가능합니다.



---

## 요약 비교 테이블

| 구분 | ALB + ACM | NLB + EC2 직접 설치 | CloudHSM 오프로딩 |
| --- | --- | --- | --- |
| **인증서 위치** | ALB (ACM) | EC2 내부 파일 | CloudHSM (HW 내부) |
| **운영 난이도** | 낮음 (매우 쉬움) | 보통 | 높음 (복잡함) |
| **EC2 CPU 부하** | 낮음 (LB에서 처리) | 높음 | 낮음 (HSM에서 처리) |
| **보안 수준** | 표준 | 높음 | 매우 높음 (FIPS 준수) |
