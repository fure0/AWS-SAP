## Amazon ECR (Elastic Container Registry) 개요

Amazon ECR은 AWS에서 제공하는 완전 관리형 **Docker 컨테이너 레지스트리** 서비스입니다. 개발자가 Docker 컨테이너 이미지를 손쉽게 저장, 관리 및 배포할 수 있도록 지원합니다.

### 리포지터리 유형

* **프라이빗(Private) 리포지터리:** 조직 내부에서만 접근 가능한 비공개 저장소입니다.
* **퍼블릭(Public) 리포지터리:** 누구나 이미지를 검색하고 다운로드할 수 있는 공개 저장소입니다. ([gallery.ecr.aws](https://gallery.ecr.aws)에서 확인 가능)

---

## 핵심 아키텍처 및 통합

1. **ECS와의 통합:** ECS 클러스터의 인스턴스(또는 Fargate)는 ECR에서 이미지를 Pull 하여 컨테이너를 실행합니다.
2. **보안 및 권한 제어:** ECR에 대한 모든 액세스는 **AWS IAM**을 통해 제어됩니다.
> **💡 시험 팁:**
> 만약 이미지 Pull 과정에서 권한 오류가 발생한다면, 가장 먼저 IAM 정책(Policy) 설정을 확인해야 합니다.



---

## 주요 기능 및 글로벌 배포

### 1. CI/CD 파이프라인 연동

* **프로세스:** CodeBuild가 소스 코드를 바탕으로 이미지를 빌드 → 생성된 이미지를 ECR에 **Push** 합니다.

### 2. 교차 리전 및 교차 계정 복제 (Replication)

* **기능:** 한 리전에 푸시된 이미지를 다른 리전이나 다른 AWS 계정으로 자동 복제합니다.
* **장점:** 이미지를 리전마다 새로 빌드할 필요가 없으며, 지연 시간을 줄여 **글로벌 애플리케이션**을 구축하는 데 필수적입니다.

### 3. 이미지 관리 기능

* **버저닝 및 이미지 태그:** 이미지의 버전을 관리하고 태그를 부여합니다.
* **이미지 라이프사이클(Lifecycle):** 오래된 이미지나 태그 없는 이미지를 자동으로 삭제하여 저장 비용을 최적화합니다.

---

## 이미지 스캐닝 (보안 취약점 탐지)

컨테이너의 보안을 위해 이미지를 푸시할 때 취약점을 스캔하는 기능입니다.

| 구분 | 기본 스캐닝 (Basic Scanning) | 고급 스캐닝 (Enhanced Scanning) |
| --- | --- | --- |
| **주체** | ECR 자체 서비스 | **Amazon Inspector** |
| **범위** | 공통 취약점(CVE) 검색 | OS + **프로그래밍 언어 패키지** 취약점 탐색 |
| **심층도** | 표준 수준의 스캔 | 심층적인 고급 스캔 |
| **이벤트 알림** | ECR → EventBridge | **Inspector** → EventBridge |

* **Scan on Push:** 이미지를 리포지터리에 푸시하는 즉시 자동으로 스캔을 시작하도록 설정할 수 있습니다.
* **결과 확인:** 두 방식 모두 AWS 콘솔에서 직접 결과를 확인할 수 있습니다.
