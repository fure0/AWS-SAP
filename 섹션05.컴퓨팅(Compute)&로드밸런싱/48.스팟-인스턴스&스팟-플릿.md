# 🚀 AWS EC2 스팟 인스턴스 & 스팟 플릿 완벽 정리

## 1. EC2 스팟 인스턴스 (Spot Instances) 기본 개념

스팟 인스턴스는 AWS의 남는 예비 용량을 활용하여 **온디맨드 대비 최대 90% 할인**된 가격으로 이용할 수 있는 서비스입니다.

### 💰 작동 원리 및 가격 결정

* **최대 가격(Max Price) 설정**: 사용자가 지불 용의가 있는 최대 가격을 정의합니다.
* **스팟 가격(Spot Price)**: 공급과 수요에 따라 실시간으로 변동하는 현재 가격입니다.
* **성립 조건**: `현재 스팟 가격 <= 사용자의 최대 가격`일 때 인스턴스가 실행됩니다.
* **중단 메커니즘**: 스팟 가격이 사용자의 최대 가격을 초과하거나 AWS에 용량이 부족해지면 인스턴스가 **중지(Stop)** 또는 **종료(Terminate)**됩니다.
* **2분 유예 알림**: 회수 전 2분의 시간이 주어지며, 이때 데이터 저장 및 애플리케이션 로그 정리를 수행해야 합니다.



### 📊 가격 변동의 특징

* **가용 영역(AZ)별 차이**: 같은 인스턴스 타입(예: M4.large)이라도 AZ(A, B, C 등)마다 가격이 다릅니다.
* **입찰 전략**: 최대 가격을 높게 설정하면 인스턴스를 유지할 확률이 높아지지만, 비용 절감 폭은 줄어들 수 있습니다.

### ✅ 권장 및 비권장 사례

| 구분 | 내용 |
| --- | --- |
| **권장 작업** | 배치 작업, 데이터 분석, 장애 내성이 있는(Fault-tolerant) 워크로드 |
| **비권장 작업** | **데이터베이스**, 중요 업무용 애플리케이션 (갑작스러운 회수 시 데이터 손실 위험) |

---

## 2. 스팟 플릿 (Spot Fleet)

스팟 플릿은 비용 절감을 극대화하기 위해 **스팟 인스턴스(필요 시 온디맨드 포함)의 집합**을 지능적으로 관리하는 서비스입니다.

### 💡 핵심 특징

* **목표 용량(Target Capacity)**: 설정한 가격 제약 조건 내에서 원하는 컴퓨팅 용량을 유지하려고 노력합니다.
* **다중 풀(Launch Pools) 활용**: 다양한 인스턴스 유형(Type), 운영 체제(OS), 가용 영역(AZ)을 조합하여 여러 풀을 정의할 수 있습니다.
* **자동 최적화**: 사용자가 일일이 선택할 필요 없이, 플릿이 가장 적합한 풀을 선택하여 인스턴스를 할당합니다.

### 🛠 할당 전략 (Allocation Strategies)

시험 및 실무에서 매우 중요한 4가지 전략입니다.

1. **최저 가격 (Lowest Price)**
* 가장 저렴한 풀에서 인스턴스를 실행합니다.
* **특징**: 비용 최적화에 최고이며, 실행 시간이 매우 짧은 작업에 유리합니다.


2. **분산 (Diversified)**
* 정의된 모든 풀에 인스턴스를 고르게 분산시킵니다.
* **특징**: 한 풀이 종료되어도 다른 풀이 살아있으므로 **가용성**이 높고 긴 작업에 유리합니다.


3. **용량 최적화 (Capacity Optimized)**
* 원하는 인스턴스 수에 대해 가장 가용 용량이 넉넉한 풀을 선택합니다.


4. **가격 용량 최적화 (Price Capacity Optimized) ⭐ 추천**
* 가장 용량이 넉넉한 풀들을 먼저 찾고, 그중에서 가격이 가장 낮은 것을 선택합니다. 대부분의 워크로드에 가장 적합합니다.



---

## 3. 요약: 스팟 인스턴스 vs 스팟 플릿

| 비교 항목 | 스팟 인스턴스 (Spot Instance) | 스팟 플릿 (Spot Fleet) |
| --- | --- | --- |
| **복잡성** | 단순함 (특정 타입/AZ 선택) | 높음 (여러 타입/AZ 조합) |
| **유연성** | 낮음 | 높음 (다양한 인스턴스 풀 활용) |
| **지능형 할당** | 사용자 수동 관리 | 전략에 따른 자동 할당 (최저가 등) |
| **주요 목적** | 단순 비용 절감 | 대규모 용량의 비용 및 가용성 최적화 |

> **핵심 팁**: 시험에서 **"최대한의 비용 절감"**이나 **"다양한 인스턴스 타입을 조합한 성능 확보"**가 언급된다면 **스팟 플릿**이 정답일 확률이 높습니다.
