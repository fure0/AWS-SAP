## 1. Amazon S3 기본 개념 및 특징

* **객체 스토리지:** 서버리스 기반의 무제한 스토리지 (사용한 만큼 비용 지불).
* **데이터 관리:** 키(Key)를 사용하여 객체에 액세스. (인덱싱/쿼리 기능 없음 → 필요 시 DynamoDB 병행 사용).
* **안티패턴 (S3 사용이 부적절한 경우):**
* **파일 시스템 대용:** POSIX 미지원, EC2에 직접 마운트 불가 (대신 **EFS** 권장).
* **특성:** 작은 파일이 너무 많은 경우, 파일 잠금(Locking)이 필요한 경우.
* **데이터 변화:** 자주 변경되는 데이터나 동적 콘텐츠 위주의 웹사이트.



---

## 2. 스토리지 클래스 및 수명 주기(Lifecycle)

S3는 비용 최적화를 위해 다양한 스토리지 클래스를 제공하며, **수명 주기 정책**을 통해 자동 전환/삭제가 가능합니다.

| 분류 | 스토리지 클래스 | 특징 |
| --- | --- | --- |
| **일반/지능형** | Standard, Intelligent-Tiering | 자주 사용하거나 패턴을 모를 때 |
| **Standard-IA** | Standard-IA, One Zone-IA | 자주 사용하지 않지만 빠른 액세스 필요 시 |
| **Glacier (아카이브)** | Instant Retrieval, Flexible Retrieval, Deep Archive | 장기 보관용, 인출 속도에 따라 선택 |

---

## 3. 복제 기능 (Replication)

복제를 위해서는 **버전 관리(Versioning)** 활성화가 필수입니다.

* **CRR (Cross Region Replication):** 서로 다른 리전 간 복제 (재해 복구, 레이턴시 감소).
* **SRR (Same Region Replication):** 동일 리전 내 복제 (로그 통합, 테스트 환경 등).
* **S3 RTC (Replication Time Control):** * 객체의 99.99%를 **15분 이내** 복제 보장.
* 임곗값 초과 시 CloudWatch 알람 및 메트릭 제공 (컴플라이언스 용도).


* **주의:** 복제 시 타겟 버킷의 스토리지 티어는 자동으로 고려되지 않으므로, 타겟에서 별도의 수명 주기 규칙 관리가 필요합니다.

---

## 4. S3 이벤트 알림 (Event Notifications)

객체 생성, 삭제, 복제 등의 이벤트에 반응하여 후속 작업을 처리합니다.

### ① 일반 S3 이벤트 알림

* **대상:** SNS, SQS, Lambda.
* **특징:** 이름 접두사/접미사(예: `.jpg`)로 필터링 가능. (예: 썸네일 자동 생성).
* **성능:** 보통 수 초 내 전달되나 1분 이상 걸릴 수 있음.

### ② Amazon EventBridge 통합 (권장)

* S3의 모든 이벤트를 EventBridge로 전송하여 확장성 극대화.
* **장점:** * **고급 필터링:** 메타데이터, 객체 크기 등으로 정교하게 필터링 가능.
* **다중 대상:** 하나의 규칙으로 Step Functions, Kinesis 등 18개 이상 서비스에 전달.
* **안정성:** 이벤트 재생(Replay) 및 아카이브 기능 제공.



---

## 5. S3 성능 최적화 및 확장

S3는 요청 부하에 따라 자동 확장되지만, 특정 임곗값을 이해하는 것이 중요합니다.

### ① 접두사(Prefix)당 성능

* **성능 지표:** 접두사당 **초당 PUT 3,500회 / GET 5,500회** 요청 처리.
* **확장 방법:** 접두사를 분산하여 설계하면 성능을 배수로 늘릴 수 있음.
* 예: `bucket/folder1/`, `bucket/folder2/`는 각각 독립된 성능 임곗값을 가짐.



### ② 업로드 성능 개선

* **Multipart Upload:** 100MB 이상 권장, **5GB 이상 필수**. 파일을 조각내어 병렬 업로드 (실패 시 해당 조각만 재전송).
* **S3 Transfer Acceleration:** 전 세계 엣지 로케이션을 통해 AWS 프라이빗 네트워크를 활용하여 전송 속도 향상.

### ③ 다운로드 성능 개선

* **S3 Byte-Range Fetches:** 파일의 특정 바이트 범위만 병렬로 GET 요청.
* 전체 대역폭 사용률을 높여 다운로드 속도 향상.
* 파일의 헤더(Header) 부분만 빠르게 확인하여 비용/대역폭 절감.



---

## 6. S3 Select 및 유틸리티

* **불완전한 멀티파트 업로드 삭제:** 업로드 중단 시 남은 찌꺼기 파일을 **수명 주기 정책**으로 자동 삭제하여 비용 방지.
* **S3 Select / Glacier Select:** * **서버 측 필터링:** SQL을 사용하여 필요한 데이터(행/열)만 추출해서 가져옴.
* **효과:** 네트워크 전송량 감소 → **성능 최대 400% 향상, 비용 최대 80% 절감**.
