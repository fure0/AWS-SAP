# 📊 Amazon Kinesis 서비스 완벽 정리

Amazon Kinesis는 대규모 **실시간 데이터 스트리밍**을 수집, 처리 및 분석하는 관리형 서비스입니다. 애플리케이션 로그, IoT 센서 데이터, 클릭스트림 등을 실시간으로 처리할 때 최적의 선택입니다.

## 1. Kinesis의 핵심 서비스 구성

Kinesis는 역할에 따라 크게 세 가지 서비스로 나뉩니다.

* **Kinesis Data Streams:** 저지연(Low-latency) 데이터 수집 및 실시간 처리.
* **Kinesis Data Analytics:** SQL을 사용하여 스트림 데이터를 실시간으로 분석.
* **Kinesis Data Firehose:** 데이터를 S3, Redshift, OpenSearch(ElasticSearch), Splunk 등의 저장소로 로드.

---

## 2. Kinesis Data Streams 상세 분석

데이터를 샤드(Shard) 단위로 분할하여 수집하는 서비스입니다.

### 💡 주요 특징

* **고가용성:** 데이터가 3개의 가용 영역(AZ)에 동기식으로 복제됩니다.
* **데이터 보존:** 기본 **24시간**, 설정에 따라 최대 **365일(1년)**까지 보관 가능합니다.
* **재생 가능(Replay):** 데이터가 삭제되지 않고 보관되므로, 과거 데이터를 다시 처리할 수 있습니다.
* **다중 소비:** SQS와 달리, **여러 애플리케이션이 동일한 스트림을 동시에 소비**할 수 있습니다. (Pub/Sub 구조)
* **불변성:** 한 번 삽입된 데이터는 수정이나 삭제가 불가능합니다.

### 🏗️ 용량 모드 (Capacity Modes)

1. **온디맨드 (On-demand):** 용량 계획 필요 없음. 워크로드에 따라 자동으로 샤드 수 확장.
2. **프로비저닝 (Provisioned):** 사용자가 직접 샤드 수를 관리. `리샤딩(Resharding)`을 통해 샤드 수를 조절합니다.

---

## 3. 생산자 (Producers) 와 소비자 (Consumers)

### 📤 생산자 (데이터를 넣는 쪽)

* **AWS SDK:** 단순한 데이터 전송.
* **Kinesis Producer Library (KPL):** 배치 처리, 압축, 재시도 기능을 제공하는 강력한 라이브러리(C++, Java).
* **Kinesis Agent:** EC2 등의 서버에서 로그 파일을 실시간으로 모니터링하고 전송할 때 사용.

### 📥 소비자 (데이터를 읽는 쪽)

* **Lambda:** 이벤트 소스 매핑을 통해 데이터 처리.
* **Kinesis Client Library (KCL):** 여러 인스턴스에서 병렬로 데이터를 읽을 때 사용.
* **체크포인트:** 읽은 위치를 **DynamoDB**에 기록하여 장애 발생 시 중단된 지점부터 재개 가능.


* **Kinesis Data Firehose / Analytics:** 다른 서비스로 전달하거나 분석.

---

## 4. 성능 한계 및 확장 (Limits)

| 구분 | 제한 사항 (샤드당) | 비고 |
| --- | --- | --- |
| **생산자 (쓰기)** | 1MB/s 또는 초당 1,000개 메시지 | 초과 시 `ProvisionedThroughputException` 발생 |
| **클래식 소비자 (읽기)** | 총합 2MB/s, 초당 5회 API 호출 | 모든 소비자가 대역폭을 공유함 |
| **향상된 팬아웃 (읽기)** | **소비자당** 2MB/s | Push 방식, 저지연, 확장성 우수 |

> **핵심 팁:** 처리량을 늘리는 가장 기본적인 방법은 **샤드(Shard)를 추가**하는 것입니다.

---

### 🔍 SQS vs Kinesis Streams 차이점 요약

* **SQS:** 메시지를 읽으면 삭제됨(기본), 개별 메시지 처리 위주.
* **Kinesis:** 데이터가 보존 기간 동안 유지됨, 여러 소비자가 같은 데이터 읽기 가능, 대규모 실시간 스트리밍에 적합.
