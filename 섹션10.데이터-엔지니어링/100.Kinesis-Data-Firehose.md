# 1. Kinesis Data Firehose 개요

Kinesis Data Firehose는 생산자로부터 데이터를 수집하여 다양한 목적지(Destinations)로 전달하는 **완전 관리형 데이터 추출, 변환, 로드(ETL) 서비스**입니다.

* **관리 방식:** 서버리스(Serverless) 및 완전 관리형 (관리 불필요)
* **확장성:** 데이터 부하에 따라 자동으로 스케일링
* **비용 모델:** 전송된 데이터 양에 대해서만 비용 지불 (Pay-as-you-go)
* **전달 방식:** **근 실시간(Near Real-Time)** (Batch 처리 방식 때문)

---

# 2. 데이터 흐름 (Architecture)

### ① 데이터 소스 (Sources)

* **Kinesis Data Streams** (가장 일반적)
* 애플리케이션, SDK, Kinesis Agent
* CloudWatch Logs & Events
* IoT 기기 데이터

### ② 데이터 변환 (Transformation) - *선택 사항*

* **AWS Lambda**를 사용하여 데이터를 목적지에 넣기 전 변환 가능.
* 예: JSON 형식을 CSV로 변환 (다양한 블루프린트 제공).

### ③ 목적지 (Destinations)

| 구분 | 종류 | 특이사항 |
| --- | --- | --- |
| **AWS 서비스** | **Amazon S3** | 모든 데이터의 기본 저장소 |
|  | **Amazon Redshift** | S3에 먼저 저장 후 `COPY` 명령으로 로드 |
|  | **Amazon OpenSearch** | 로그 분석 및 검색 용도 |
| **제3자 파트너** | Splunk, MongoDB, Datadog, New Relic 등 | API를 통한 연동 |
| **사용자 지정** | **HTTP Endpoint** | 자체 API가 있는 모든 엔드포인트 |

### ④ 백업 및 실패 처리

* **모든 데이터 백업:** 모든 원본 데이터를 S3에 백업 가능.
* **전송 실패 백업:** 목적지 장애나 변환 오류(Lambda) 발생 시 실패한 데이터를 S3에 저장하여 추후 복구 가능.

---

# 3. 핵심 메커니즘: 버퍼링 (Buffering)

Firehose가 '실시간'이 아닌 **'근 실시간'**인 이유는 데이터를 일정한 단위로 모아서(Batch) 보내기 때문입니다. 다음 두 가지 조건 중 **하나라도 먼저 충족되면** 데이터가 플러시(전송)됩니다.

1. **Buffer Size (크기):** 최소 1MB ~ 최대 (예: 32MB, 128MB 등 설정 가능). 데이터가 설정한 크기만큼 차면 전송.
2. **Buffer Interval (시간):** 최소 60초(1분) ~ 최대 900초(15분). 설정한 시간이 지나면 크기와 상관없이 전송.
* *참고: 버퍼링을 0초로 설정해도 데이터 전달에는 수 초가 소요되므로 여전히 '근 실시간'으로 간주합니다.*



---

# 4. Kinesis Data Streams vs. Firehose 비교

시험에서 자주 묻는 두 서비스의 결정적인 차이점입니다.

| 항목 | Kinesis Data Streams (KDS) | Kinesis Data Firehose (KDF) |
| --- | --- | --- |
| **목적** | 대규모 수집 및 실시간 처리 | 수집 및 전송 (ETL) |
| **지연 시간** | **실시간** (70~200ms) | **근 실시간** (최소 60초 또는 1MB) |
| **코드 작성** | 생산자/소비자 코드 직접 작성 필요 | 코드 불필요 (설정 기반) |
| **확장성** | 수동 관리 (샤드 분할/병합) | **자동 확장** |
| **데이터 저장** | 1일~365일 보관 (재생 가능) | **저장 안 함** (데이터 통과 후 삭제) |
| **비용** | 프로비저닝된 샤드 단위 과금 | 처리된 데이터 양 단위 과금 |
| **다중 소비자** | 지원함 (여러 곳에서 읽기 가능) | 지원 안 함 (목적지로 바로 전송) |

---

> **💡 핵심 요약**
> 만약 S3로 데이터를 **실시간(즉시)**으로 보내야 한다면 Firehose 대신 **Kinesis Data Streams + Lambda** 조합을 사용해야 합니다. 하지만 비용 효율성과 관리 편의성을 생각한다면 **Firehose**가 최적의 선택입니다.
