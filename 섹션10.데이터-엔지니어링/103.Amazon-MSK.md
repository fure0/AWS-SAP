## 1. Amazon MSK란 무엇인가?

**Amazon MSK**는 인기 있는 오픈 소스 스트리밍 플랫폼인 **Apache Kafka**를 AWS 환경에서 손쉽게 구축하고 운영할 수 있게 해주는 완전 관리형 서비스입니다.

* **관리의 용이성:** Kafka 브로커(Broker) 노드와 Zookeeper 노드를 자동으로 생성, 관리 및 업데이트합니다.
* **고가용성:** 최대 3개의 가용 영역(Multi-AZ)에 걸쳐 클러스터를 배치하여 안정성을 확보합니다.
* **자동 복구:** 일반적인 Kafka 오류 발생 시 시스템이 자동으로 복구 프로세스를 진행합니다.
* **유연한 스토리지:** 데이터는 EBS 볼륨에 저장되며, 비용을 지불하는 한 원하는 기간(예: 1년 이상) 동안 무제한으로 보존할 수 있습니다.

### MSK Serverless (서버리스 옵션)

* 서버를 직접 프로비저닝하거나 용량을 관리할 필요가 없습니다.
* MSK가 데이터 수요에 따라 리소스와 스토리지를 자동으로 확장/축소합니다.

---

## 2. Apache Kafka의 작동 원리

Kafka는 데이터를 실시간으로 수집하고 전달하는 "중단점" 역할을 합니다.

* **Producer (생성자):** Kinesis, IoT 디바이스, RDS 등에서 데이터를 수집하여 Kafka 토픽(Topic)으로 전송합니다.
* **Topic (토픽):** 데이터가 저장되는 카테고리입니다. 브로커들 사이에 데이터가 완벽하게 복제되어 안전하게 보관됩니다.
* **Consumer (소비자):** 실시간 스트리밍 데이터를 토픽에서 가져와 처리합니다. 처리된 데이터는 S3, EMR, SageMaker 등으로 전송됩니다.

---

## 3. Kinesis Data Streams vs Amazon MSK 비교

시험에서 자주 다루는 두 서비스의 핵심 차이점입니다.

| 구분 | Kinesis Data Streams | Amazon MSK |
| --- | --- | --- |
| **메시지 크기 제한** | 기본 **1MB** 고정 | 기본 1MB (설정에 따라 **10MB 이상 확장 가능**) |
| **데이터 단위** | **Shards** (샤드) | **Partitions** (파티션) |
| **용량 조절** | 샤드 분할(Split) 및 병합(Merge) 가능 | 파티션 **추가만 가능** (제거 불가) |
| **암호화** | In-flight 및 At-rest 암호화 지원 | PLAINTEXT 또는 TLS(In-flight), At-rest 지원 |
| **데이터 보존** | 최대 1년 (보통 7일~365일) | **원하는 만큼 (1년 이상도 가능)** |

---

## 4. Amazon MSK 데이터 소비 방법 (Consumer)

MSK에 저장된 데이터를 처리하기 위한 다양한 AWS 서비스 연동 방법입니다.

1. **Kinesis Data Analytics (for Apache Flink):** Flink 애플리케이션을 통해 MSK 클러스터의 데이터를 직접 읽고 분석합니다.
2. **AWS Glue:** Apache Spark Streaming을 활용하여 스트리밍 ETL(추출, 변환, 로드) 작업을 수행합니다.
3. **AWS Lambda:** MSK를 이벤트 소스(Event Source)로 지정하여 데이터가 들어올 때마다 함수를 실행합니다.
4. **자체 소비자(Custom Consumer):** EC2 인스턴스, ECS(컨테이너), EKS(쿠버네티스) 등에서 직접 작성한 Kafka Consumer 코드를 실행합니다.

---

> **Tip:** 시험 목적이라면 Kinesis와 MSK의 **메시지 크기 제한 차이**와 **데이터 보존 기간의 유연성**을 중점적으로 기억하세요.