## 1. 교차 영역 로드 밸런싱 (Cross-Zone Load Balancing)

로드 밸런서 노드가 자신이 속한 가용 영역(AZ) 외에 다른 AZ에 있는 대상(인스턴스)으로도 트래픽을 분산할지 결정하는 설정입니다.

### ① 활성화된 경우 (Enabled)

* **동작:** 각 로드 밸런서 노드가 모든 가용 영역에 등록된 **모든 인스턴스**에 트래픽을 고르게 분산합니다.
* **예시:** AZ 1에 인스턴스 2개, AZ 2에 8개가 있을 때 (총 10개)
* 각 로드 밸런서 노드는 전체 트래픽을 10개 인스턴스에 10%씩 전달합니다.
* 인스턴스 개수 불균형과 상관없이 모든 인스턴스가 동일한 부하를 가집니다.



### ② 비활성화된 경우 (Disabled)

* **동작:** 로드 밸런서 노드가 **자신이 속한 AZ 내의 인스턴스**로만 트래픽을 보냅니다.
* **예시:** 클라이언트 트래픽이 AZ 1, AZ 2 로드 밸런서에 50:50으로 들어올 때
* **AZ 1 (인스턴스 2개):** 각 인스턴스는 전체의 25% 부하를 받음.
* **AZ 2 (인스턴스 8개):** 각 인스턴스는 전체의 6.25% 부하를 받음.


* **결과:** 특정 AZ에 인스턴스가 적으면 해당 인스턴스들에 과부하가 발생할 수 있습니다.

### ③ 로드 밸런서별 특징 및 비용

| 로드 밸런서 종류 | 기본 설정 | 교차 AZ 데이터 전송 비용 |
| --- | --- | --- |
| **ALB (Application)** | **항상 활성화** (변경 불가) | 무료 |
| **NLB (Network)** | 비활성화 | **유료** (활성 시 비용 발생) |
| **CLB (Classic)** | 비활성화 | 무료 (활성 시에도 무료) |
| **GWLB (Gateway)** | 비활성화 | **유료** (활성 시 비용 발생) |

---

## 2. 스티키 세션 (Sticky Sessions / Session Affinity)

클라이언트가 특정 기간 동안 **동일한 백엔드 인스턴스로 계속 연결**되도록 유지하는 기능입니다.

* **작동 방식:** 로드 밸런서가 클라이언트에게 **쿠키(Cookie)**를 발급합니다. 클라이언트는 이후 요청 시 이 쿠키를 함께 보내며, 로드 밸런서는 이를 보고 이전에 연결됐던 인스턴스로 라우팅합니다.
* **활용 사례:** 사용자 로그인 정보, 장바구니 등 세션 데이터가 특정 서버에만 저장되어 있어 세션 유지가 필요한 경우.
* **단점:** 특정 인스턴스에 트래픽이 몰리는 **로드 불균형**이 발생할 수 있습니다.
* **지원:** ALB 및 CLB에서 지원합니다.

---

## 3. 요청 라우팅 알고리즘 (Routing Algorithms)

### ① 최저 잔여 요청 (Least Outstanding Requests)

* **원리:** 처리 중인(대기 중인) 요청 수가 가장 적은 인스턴스에 우선적으로 요청을 보냅니다.
* **특징:** 인스턴스의 처리 능력이 다르거나 요청별 처리 시간이 다를 때 효율적입니다. (가장 덜 바쁜 서버 찾기)
* **지원:** ALB, CLB

### ② 라운드 로빈 (Round Robin)

* **원리:** 인스턴스의 부하 상태와 상관없이 순서대로(1번 → 2번 → 3번 → 다시 1번...) 요청을 배분합니다.
* **특징:** 모든 요청의 처리 부하가 비슷할 때 적합합니다.
* **지원:** ALB, CLB

### ③ 플로우 해시 (Flow Hash)

* **원리:** 5-Tuple(프로토콜, 출발지/목적지 IP, 출발지/목적지 포트) 및 TCP 시퀀스 번호를 해싱하여 타겟을 결정합니다.
* **특징:** TCP/UDP 연결이 유지되는 동안 동일한 인스턴스로 라우팅됩니다. NLB의 스티키 세션과 유사한 효과를 냅니다.
* **지원:** **NLB 전용**
