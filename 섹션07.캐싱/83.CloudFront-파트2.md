## 1. CloudFront 지리적 제한 (Geographic Restriction)

CloudFront는 전 세계 엣지 로케이션을 사용하지만, 특정 국가의 액세스를 제어해야 할 때 이 기능을 사용합니다.

* **동작 원리:** CloudFront 내부의 **서드 파티 Geo-IP 데이터베이스**를 활용하여 사용자의 국가를 판별합니다.
* **제한 방식:**
  * **허용 목록 (Allow List):** 승인된 국가의 사용자만 콘텐츠에 접근 가능.
  * **차단 목록 (Block List):** 특정 국가의 사용자가 콘텐츠에 접근하는 것을 방지.


* **주요 사례:** 저작권법 준수(특정 지역에만 방송 송출), 지역별 콘텐츠 차별화.
* **고급 활용:** CloudFront가 요청 헤더에 `CloudFront-Viewer-Country`를 자동으로 추가하므로, 이를 통해 오리진이나 **Lambda@Edge**에서 국가별 맞춤형 로직을 실행할 수 있습니다.

---

## 2. 가격 등급 (Price Classes)

엣지 로케이션의 데이터 전송 비용은 지역마다 다릅니다. (예: 인도 등은 비싸고, 미국/유럽 등은 저렴함) 비용 최적화를 위해 사용 범위를 제한할 수 있습니다.

| 등급 | 특징 | 비고 |
| --- | --- | --- |
| **Price Class All** | 전 세계 모든 리전의 엣지 로케이션 사용 | 최고의 성능, 가장 높은 비용 |
| **Price Class 200** | 대부분의 리전 사용 (가장 비싼 리전 제외) | 성능과 비용의 타협점 |
| **Price Class 100** | 비용이 가장 저렴한 리전만 사용 (미국, 멕시코, 캐나다 등) | 최저 비용 |

---

## 3. CloudFront 서명된 URL (Signed URL)

특정 사용자에게만 일정 기간 콘텐츠 접근 권한을 부여할 때 사용합니다. 특히 S3와 통합 시 **OAC(Origin Access Control)**와 함께 사용되어 보안을 강화합니다.

### 서명된 URL 생성 흐름

1. **클라이언트**가 **애플리케이션 서버**에 콘텐츠 요청.
2. 서버는 인증/인가를 확인한 뒤, **SDK**를 사용하여 **서명된 URL** 생성.
3. 서버가 클라이언트에 URL 반환.
4. 클라이언트는 이 URL을 사용하여 **CloudFront**에 직접 접근하여 콘텐츠 확보.

### CloudFront 서명된 URL vs S3 미리 서명된 URL (Pre-signed URL)

| 구분 | CloudFront 서명된 URL | S3 미리 서명된 URL |
| --- | --- | --- |
| **대상** | 오리진 상관없이 모든 경로 (S3 외 포함) | 오직 S3 객체에만 적용 |
| **관리 주체** | 계정 키 페어 (루트 계정 관리) | IAM Principal (IAM 키 사용) |
| **기능** | IP, 경로, 날짜별 복잡한 필터링 가능 | URL 생성자의 권한을 그대로 대행 |
| **효율성** | **엣지 로케이션의 캐시 활용 가능** | 캐시 활용 불가 (오리진 직접 접근) |

---

## 4. 사용자 지정 오류 페이지 (Custom Error Pages)

오리진 서버에서 오류가 발생했을 때, 사용자에게 브라우저 기본 오류 창 대신 브랜드화된 페이지를 보여주는 기능입니다.

* **동작 방식:** 오리진이 `4xx` 또는 `5xx` 코드를 반환하면, CloudFront가 미리 설정된 **사용자 지정 오류 페이지(예: S3에 저장된 HTML)**를 대신 클라이언트에게 전송합니다.
* **캐싱:** 오류 응답 자체도 **최소 TTL(Minimum TTL)** 설정을 통해 엣지 로케이션에 캐싱할 수 있어 오리진의 부담을 줄입니다.
* **활용:** 403(Forbidden) 오류 발생 시 안내 페이지를 보여주거나 메인 페이지로 리다이렉션 유도.
