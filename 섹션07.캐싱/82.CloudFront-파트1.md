## 1. Amazon CloudFront 개요

CloudFront는 전 세계 사용자에게 데이터, 비디오, 애플리케이션 및 API를 낮은 대기 시간과 높은 전송 속도로 안전하게 전달하는 **콘텐츠 전송 네트워크(CDN)** 서비스입니다.

* **엣지 로케이션(Edge Location):** 전 세계 200개 이상의 PoP(Points of Presence)를 통해 콘텐츠를 캐싱하여 백엔드 부하를 줄이고 성능을 향상합니다.
* **보안 통합:** AWS Shield, WAF, Route 53와 긴밀하게 통합되어 DDoS 공격 및 웹 취약점으로부터 보호합니다.
* **지원 프로토콜:** HTTP 및 WebSocket을 지원합니다.

---

## 2. CloudFront 오리진(Origin) 종류

CloudFront가 콘텐츠를 가져오는 소스(백엔드)는 다음과 같습니다.

| 오리진 유형 | 설명 및 특징 |
| --- | --- |
| **S3 버킷** | 파일 배포에 최적화. **OAC(Origin Access Control)**를 통해 S3 직접 접근을 차단하고 CloudFront를 통해서만 접근 가능하게 설정 권장. |
| **S3 정적 웹사이트** | S3의 정적 웹사이트 호스팅 엔드포인트를 오리진으로 사용. |
| **AWS 미디어 서비스** | MediaStore 컨테이너나 MediaPackage 엔드포인트를 통해 VOD 및 라이브 스트리밍 제공. |
| **사용자 지정 오리진** | EC2 인스턴스, ALB(Application Load Balancer), API Gateway 또는 온프레미스의 HTTP 서버. |

---

## 3. S3 기반 아키텍처: CloudFront vs S3 복제(CRR)

시험에서 자주 묻는 두 방식의 차이점입니다.

* **CloudFront (CDN 방식):** 전 세계 엣지에 데이터를 캐시(TTL 설정). **정적 콘텐츠**를 전 세계 어디서나 빠르게 제공할 때 유리함.
* **S3 Cross-Region Replication (CRR):** 특정 리전 간에 데이터를 실시간 복제. **동적 콘텐츠**나 소수 리전에서 낮은 대기 시간이 필요할 때, 혹은 재해 복구(DR) 용도로 적합.

---

## 4. 사용자 지정 오리진 보안 (ALB/EC2)

사용자가 CloudFront를 거치지 않고 ALB나 EC2의 퍼블릭 IP로 직접 접속하는 것을 막아야 합니다.

1. **사용자 지정 HTTP 헤더:** CloudFront가 오리진으로 요청을 보낼 때 **비밀 헤더(Secret Header)**를 추가합니다. 오리진(ALB 등)은 이 헤더가 있는 요청만 수락하고 나머지는 거부합니다.
2. **보안 그룹(Security Group) 제한:** 오리진의 보안 그룹에서 **CloudFront의 퍼블릭 IP 대역**만 인바운드 허용하도록 설정합니다.

---

## 5. 오리진 그룹(Origin Groups) 및 고가용성

고가용성(HA)과 장애 조치(Failover)를 위해 **오리진 그룹**을 구성할 수 있습니다.

* **구성:** 1개의 기본 오리진(Primary) + 1개의 보조 오리진(Secondary).
* **작동 방식:** 기본 오리진이 특정 오류 코드(예: 5xx)를 반환하면 CloudFront가 자동으로 보조 오리진으로 요청을 재시도합니다.
* **멀티 리전 설계:** * 기본(us-east-1)과 보조(eu-west-1)를 서로 다른 리전에 두어 리전 장애에 대비할 수 있습니다.
* S3 버킷 간에 복제를 설정해 두면 데이터 일관성을 유지하며 가용성을 극대화할 수 있습니다.
