## ☁️ AWS Storage Gateway: 파일 게이트웨이 활용 가이드

파일 게이트웨이는 온프레미스 환경에서 **NFS**나 **SMB** 프로토콜을 통해 클라우드 스토리지인 **Amazon S3**에 데이터를 저장하고 관리할 수 있게 해주는 가교 역할을 합니다.

### 1. 하이브리드 클라우드 구축 및 이관

* **온프레미스와 EC2의 연결:** 온프레미스 서버뿐만 아니라 VPC 내의 EC2 인스턴스에도 파일 게이트웨이 어플라이언스를 추가하여 S3를 일반 파일 시스템처럼 사용할 수 있습니다.
* **클라우드 마이그레이션:** 기존 애플리케이션의 프로토콜(NFS, SMB)을 수정하지 않고도 데이터를 S3로 자연스럽게 이관하는 첫 단계로 활용됩니다.

### 2. S3 생태계를 활용한 데이터 처리

데이터가 S3에 저장되는 순간, AWS의 다양한 서비스와 연동하여 부가 가치를 창출할 수 있습니다.

* **서버리스 처리:** S3 이벤트를 트리거하여 **AWS Lambda**에서 파일을 자동으로 처리합니다.
* **데이터 분석:**
  * **Amazon Athena:** S3 리소스를 직접 사용하여 쿼리하므로 게이트웨이 성능에 영향을 주지 않고 분석이 가능합니다.
  * **Redshift Spectrum / EMR:** 대규모 데이터 웨어하우징 및 빅데이터 분석에 활용합니다.

* **재해 복구(DR):** S3의 **리전 간 복제(CRR)** 기능을 사용하여 데이터를 다른 리전에 자동으로 백업합니다.

---

### 3. 주요 아키텍처 패턴

#### ① 읽기 전용 복제본 (Read-Only Replica)

지리적으로 떨어진 두 데이터 센터 간의 데이터 공유를 최적화합니다.

* **구성:** 소스 센터(쓰기 가능) → S3 버킷 → 타겟 센터(읽기 전용 게이트웨이).
* **장점:** 타겟 센터의 애플리케이션은 로컬 어플라이언스에서 데이터를 읽으므로 딜레이 없이 빠른 액세스가 가능합니다.

#### ② 비용 최적화 (Lifecycle Policy)

S3의 생명 주기 정책을 활용하여 스토리지 비용을 획기적으로 절감합니다.

* **프로세스:** 자주 쓰는 데이터(S3 Standard) → 덜 쓰는 데이터(S3 Standard-IA) → 아카이브(S3 Glacier).
* **결과:** 온프레미스 파일 시스템의 용량 부담을 줄이면서 저렴한 비용으로 데이터를 유지합니다.

---

### 4. 데이터 보호 및 컴플라이언스

#### 🔄 버전 관리 및 복구 (Object Versioning)

* **버전 관리:** S3의 객체 버전 관리를 활성화하면 파일 수정 시마다 이전 버전이 보관됩니다.
* **캐시 갱신 (Refresh Cache API):** S3에서 직접 파일을 이전 버전으로 복원한 경우, 파일 게이트웨이가 이 변경 사항을 인지하도록 API를 호출하여 백엔드 싱크를 맞춰야 합니다.

#### 🔒 데이터 잠금 (Object Lock)

* **WORM(Write Once, Read Many) 구현:** 한 번 기록하면 수정/삭제가 불가능하게 설정할 수 있습니다.
* **작동 방식:** 파일 수정 시 기존 잠금된 객체는 유지되고 새 버전이 생성됩니다.
* **용도:** 금융/법률 등 규정 준수(Compliance), 감사, 원본 데이터 삭제 방지.

---

> **💡 핵심 요약**
> 파일 게이트웨이는 단순히 파일을 업로드하는 도구를 넘어, **온프레미스 환경을 S3의 강력한 데이터 분석 및 보호 기능과 결합**해주는 전략적인 솔루션입니다.